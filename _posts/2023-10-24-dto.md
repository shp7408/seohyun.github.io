---
layout: post
title: "DTO ( Data Transfer Object ) with NestJS"
subtitle: "DTOë¥¼ ì™œ ì‚¬ìš©í•´ì•¼ í•˜ì£ ?"
date: 2023-10-24 21:38:00 +0900
categories: [dto, nestjs, layer]
---
# ğŸš€ DTO (Data Transfer Object) with NestJS

ì–¼ë§ˆ ì „, íšŒì‚¬ íŒ€ì›ì—ê²Œ DTOë¥¼ ì™œ êµ³ì´ ì‚¬ìš©í•´ì•¼í•˜ëŠ”ì§€?ì— ëŒ€í•œ ì§ˆë¬¸ì„ ë°›ì•˜ë‹¤.

ê·¸ë˜ì„œ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” DTOë¥¼ ì™œ ì‚¬ìš©í•´ì•¼í•˜ëŠ”ì§€ì— ëŒ€í•´ ì•Œì•„ë³´ê³ ì í•œë‹¤.

ë¨¼ì €, DTOëŠ” Data Transfer Objectì˜ ì•½ìë¡œ, ë°ì´í„° ì „ì†¡ ê°ì²´ë¼ê³  í•œë‹¤.

DTOëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì–»ì–´ ì„œë¹„ìŠ¤ë‚˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ìœ¼ë¡œ ì „ë‹¬í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê°ì²´ì´ë‹¤.

ì•„ë§ˆ, ì•ì„œ ë°›ì€ ì§ˆë¬¸ì€, ì—”í„°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ë˜ì§€ ì™œ DTOë¥¼ ì‚¬ìš©í•´ì•¼í•˜ë‚˜? ë¼ëŠ” ì˜ë¬¸ì´ì—ˆì„ ê²ƒì´ë‹¤.

<br>
<br>

### 1. ë³´ì•ˆìƒì˜ ì´ìœ  - ì—”í„°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´, ì—”í„°í‹°ì˜ ëª¨ë“  ë°ì´í„°ê°€ ë…¸ì¶œëœë‹¤.

ì•„ë˜ ì˜ˆì‹œëŠ”, User ì— ê´€í•œ ì—”í„°í‹° í´ë˜ìŠ¤ì´ë‹¤.
```typescript
    // user.entity.ts
    import { Entity, Column, PrimaryGeneratedColumn } from 'typeorm';

    @Entity()
    export class User {
        @PrimaryGeneratedColumn()
        id: number;

        @Column()
        loginType: string;

        @Column()
        email: string;

        @Column()
        password: string;

        @Column()
        socialId: string;

        @Column()
        socialAccessToken: string;

        @Column()
        name: string;

        @Column()
        nickname: string;

        @Column()
        profileImage: string;
    }
```

ìœ„ì™€ ê°™ì€ ì—”í„°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´, ëª¨ë“  ë°ì´í„°ê°€ ë…¸ì¶œë˜ê¸° ë•Œë¬¸ì— ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ DTOë¥¼ ì‚¬ìš©í•œë‹¤.

ì•„ë˜ ì˜ˆì‹œëŠ”, íŠ¹ì • User ë¥¼ ì¡°íšŒí•˜ëŠ” API ì´ë‹¤.

``` typescript
    // user.controller.ts
    import { Controller, Get, Param } from '@nestjs/common';
    import { UserService } from './user.service';

    @Controller('user')
    class UserController {
        constructor(private readonly userService: UserService) {}

        @Get(':id')
        async getUser(@Param('id') id: number) {
            return await this.userService.getUser(id);
        }
    }

    // user.service.ts
    import { Injectable } from '@nestjs/common';
    import { InjectRepository } from '@nestjs/typeorm';
    import { Repository } from 'typeorm';
    import { User } from './user.entity';

    @Injectable()
    class UserService {
        constructor(
            @InjectRepository(User)
            private readonly userRepository: Repository<User>,
        ) {}

        async getUser(id: number) {
            return await this.userRepository.findOne(id);
        }
    }
```

ì´ API ë¥¼ í˜¸ì¶œí•˜ë©´, ì•„ë˜ì™€ ê°™ì€ ì‘ë‹µì´ ì˜¨ë‹¤.

```
    {
        "id": 1,
        "loginType": "email",
        "email": "test@test.com",
        "password": "test",
        "socialId": null,
        "socialAccessToken": null,
        "name": "test",
        "nickname": "test",
        "profileImage": null
    }
```

ëª¨ë“  ë°ì´í„°ê°€ ë…¸ì¶œë˜ê¸° ë•Œë¬¸ì— ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ DTOë¥¼ ì‚¬ìš©í•œë‹¤.

## 2. API ì˜ ì•ˆì •ì„± - ì—”í„°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´, ì—”í„°í‹°ì˜ ë°ì´í„°ê°€ ë³€ê²½ë˜ë©´ API ì‘ë‹µ ë°ì´í„°ë„ ë³€ê²½ëœë‹¤.

ì—”í„°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´, ì—”í„°í‹°ì˜ ë°ì´í„°ê°€ ë³€ê²½ë˜ë©´ API ì‘ë‹µ ë°ì´í„°ë„ ë³€ê²½ëœë‹¤.

ê¸°ì¡´ User í…Œì´ë¸”ì—ì„œ, lastLoginAt ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ì˜€ë‹¤ê³  ê°€ì •í•˜ì.

``` typescript
    @Column()
    lastLoginAt: Date;
```

ì´ ê²½ìš°, API ì‘ë‹µ ë°ì´í„°ë„ ë³€ê²½ë˜ì–´ì•¼ í•œë‹¤.

ë°±ì—”ë“œì—ì„œëŠ”, API ì‘ë‹µ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì€ í° ë¬¸ì œê°€ ë˜ì§€ ì•Šì§€ë§Œ, í”„ë¡ íŠ¸ì—”ë“œì—ì„œëŠ” í° ë¬¸ì œê°€ ëœë‹¤.

í”„ë¡ íŠ¸ì—”ë“œì—ì„œëŠ”, API ì‘ë‹µ ë°ì´í„°ê°€ ë³€ê²½ë˜ë©´, API ì‘ë‹µ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ê³³ì—ì„œ ë³€ê²½ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ DTOë¥¼ ì‚¬ìš©í•œë‹¤.

ì•„ë˜ ì˜ˆì‹œëŠ”, ë³¸ì¸ì´ ì•„ë‹Œ, ë‹¤ë¥¸ User ë¥¼ ì¡°íšŒí•˜ëŠ” API ì´ë‹¤.

```
    // ì—”í„°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°
    {
        "id": 1,
        "loginType": "email",
        "email": "test@test.com",
        "password": "test",
        "socialId": null,
        "socialAccessToken": null,
        "name": "test",
        "nickname": "test",
        "profileImage": null,
        "lastLoginAt": "2021-10-24T12:00:00.000Z" // ì¶”ê°€ëœ ì»¬ëŸ¼
    }

    // DTOë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°
    {
        "id": 1,
        "email": "test@test.com",
        "name": "test",
        "nickname": "test",
        "profileImage": null // í•„ìš”í•œ ë°ì´í„°ë§Œ ì‘ë‹µë°›ì•„ì„œ, ì¶”ê°€ëœ ì»¬ëŸ¼ì´ ì‘ë‹µë˜ì§€ ì•ŠëŠ”ë‹¤.
    }
```
ìœ„ì™€ ê°™ì´, í•„ìš”í•œ ë°ì´í„°ë§Œ ì‘ë‹µë°›ì•„ì„œ, ì¶”ê°€ëœ ì»¬ëŸ¼ì´ ì‘ë‹µë˜ì§€ ì•ŠëŠ”ë‹¤.

ì´ëŸ¬í•œ ì´ìœ ë¡œ, ì—”í„°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³ , DTOë¥¼ ì‚¬ìš©í•œë‹¤.

<br>

## 3. API ì‘ë‹µ ì†ë„ - ë¶ˆí•„ìš”í•œ ë°ì´í„°ê°€ í¬í•¨ë˜ì–´, API ì‘ë‹µ ë°ì´í„°ì˜ í¬ê¸°ê°€ ì»¤ì§„ë‹¤.

ì—”í„°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´, ë¶ˆí•„ìš”í•œ ë°ì´í„°ê°€ í¬í•¨ë˜ì–´, API ì‘ë‹µ ë°ì´í„°ì˜ í¬ê¸°ê°€ ì»¤ì§„ë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, User í…Œì´ë¸”ê³¼ ì—°ê´€ëœ Post í…Œì´ë¸”ì´ ìˆë‹¤ê³  ê°€ì •í•˜ì.

ì´ ê²½ìš°, ì—”í„°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´, User í…Œì´ë¸”ê³¼ ì—°ê´€ëœ Post í…Œì´ë¸”ì˜ ë°ì´í„°ë„ ì‘ë‹µëœë‹¤.

í•˜ì§€ë§Œ, User í…Œì´ë¸”ê³¼ ì—°ê´€ëœ Post í…Œì´ë¸”ì˜ ë°ì´í„°ëŠ” í•„ìš”í•˜ì§€ ì•Šë‹¤.

